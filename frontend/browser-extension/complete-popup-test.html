<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Popup System Test - With Working Dropdown</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 1000px;
            margin: 50px auto;
            padding: 30px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .test-container {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .header h1 {
            color: #1f2937;
            font-size: 28px;
            margin: 0 0 10px 0;
            font-weight: 800;
        }
        
        .header p {
            color: #6b7280;
            font-size: 16px;
            margin: 0;
        }
        
        .test-section {
            margin-bottom: 40px;
        }
        
        .test-section h3 {
            color: #374151;
            font-size: 20px;
            margin: 0 0 20px 0;
            font-weight: 700;
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }
        
        .test-button {
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        
        .danger { background: #ef4444; color: white; }
        .danger:hover { background: #dc2626; }
        
        .warning { background: #f59e0b; color: white; }
        .warning:hover { background: #d97706; }
        
        .caution { background: #f97316; color: white; }
        .caution:hover { background: #ea580c; }
        
        .safe { background: #10b981; color: white; }
        .safe:hover { background: #059669; }
        
        .utility { background: #6b7280; color: white; }
        .utility:hover { background: #4b5563; }
        
        .info-box {
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .info-box h4 {
            color: #0369a1;
            margin: 0 0 12px 0;
            font-size: 18px;
            font-weight: 700;
        }
        
        .info-box p {
            color: #075985;
            margin: 0;
            line-height: 1.6;
        }
        
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }
        
        .feature-item {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 16px;
        }
        
        .feature-item h5 {
            color: #1e293b;
            margin: 0 0 8px 0;
            font-size: 16px;
            font-weight: 600;
        }
        
        .feature-item p {
            color: #64748b;
            margin: 0;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .status-log {
            background: #1f2937;
            color: #f9fafb;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        
        .instructions {
            background: #fff7ed;
            border: 2px solid #fb923c;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .instructions h4 {
            color: #ea580c;
            margin: 0 0 12px 0;
            font-size: 18px;
            font-weight: 700;
        }
        
        .instructions ol {
            color: #9a3412;
            margin: 0;
            padding-left: 20px;
        }
        
        .instructions li {
            margin: 8px 0;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="header">
            <h1>üéØ Complete Popup System Test</h1>
            <p>Test the enhanced phishing alert system with working dropdown, risk bars, and detailed analysis</p>
        </div>
        
        <div class="instructions">
            <h4>üöÄ How to Test:</h4>
            <ol>
                <li>Click any test button below to see the popup alert</li>
                <li>Look for the popup in the <strong>top-right corner</strong> of your screen</li>
                <li>Click "<strong>View Analysis Details</strong>" to expand the dropdown</li>
                <li>Explore the risk assessment, progress bars, and detailed reasons</li>
                <li>Try different alert types to see color-coded severity levels</li>
            </ol>
        </div>
        
        <div class="test-section">
            <h3>üé® Test Different Alert Types</h3>
            <div class="button-grid">
                <button class="test-button danger" onclick="testHighDanger()">
                    üö® High Danger Alert
                </button>
                <button class="test-button warning" onclick="testWarning()">
                    ‚ö†Ô∏è Warning Alert
                </button>
                <button class="test-button caution" onclick="testCaution()">
                    üü° Caution Alert
                </button>
                <button class="test-button safe" onclick="testSafe()">
                    ‚úÖ Safe Email Alert
                </button>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üîß Utility Functions</h3>
            <div class="button-grid">
                <button class="test-button utility" onclick="clearAllAlerts()">
                    üßπ Clear All Alerts
                </button>
                <button class="test-button utility" onclick="testMultipleAlerts()">
                    üîÑ Test Multiple Alerts
                </button>
                <button class="test-button utility" onclick="checkSystemStatus()">
                    üìä Check System Status
                </button>
                <button class="test-button utility" onclick="showInstructions()">
                    ‚ùì Show Instructions
                </button>
            </div>
        </div>
        
        <div class="info-box">
            <h4>‚ú® Key Features</h4>
            <div class="feature-list">
                <div class="feature-item">
                    <h5>üéØ Working Dropdown</h5>
                    <p>Click "View Analysis Details" to expand full analysis with smooth animations</p>
                </div>
                <div class="feature-item">
                    <h5>üìä Risk Assessment</h5>
                    <p>Color-coded risk levels with detailed explanations and recommendations</p>
                </div>
                <div class="feature-item">
                    <h5>üìà Progress Bars</h5>
                    <p>Animated phishing risk and safety score bars with percentages</p>
                </div>
                <div class="feature-item">
                    <h5>üìù Detailed Reasons</h5>
                    <p>Comprehensive list of analysis factors with hover effects</p>
                </div>
                <div class="feature-item">
                    <h5>üé® Beautiful Design</h5>
                    <p>Professional styling with gradients, shadows, and animations</p>
                </div>
                <div class="feature-item">
                    <h5>üì± Responsive</h5>
                    <p>Works perfectly on desktop and mobile devices</p>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üìã System Status & Logs</h3>
            <div id="status-log" class="status-log">
System initializing...
            </div>
        </div>
    </div>

    <!-- Load the complete popup system -->
    <script src="complete-popup-system.js"></script>
    
    <script>
        const statusLog = document.getElementById('status-log');
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            const logMessage = `${timestamp} ${prefix} ${message}\n`;
            statusLog.textContent += logMessage;
            statusLog.scrollTop = statusLog.scrollHeight;
            console.log(message);
        }
        
        function testHighDanger() {
            log('Testing High Danger Alert with dropdown...', 'warning');
            if (window.completePhishingAlert) {
                window.completePhishingAlert.testHighDanger();
                log('High danger alert with dropdown created successfully!', 'success');
                log('Look for the popup in the top-right corner and click "View Analysis Details"', 'info');
            } else {
                log('Complete popup system not loaded!', 'error');
            }
        }
        
        function testWarning() {
            log('Testing Warning Alert with dropdown...', 'warning');
            if (window.completePhishingAlert) {
                window.completePhishingAlert.testWarning();
                log('Warning alert with dropdown created successfully!', 'success');
            } else {
                log('Complete popup system not loaded!', 'error');
            }
        }
        
        function testCaution() {
            log('Testing Caution Alert with dropdown...', 'warning');
            if (window.completePhishingAlert) {
                window.completePhishingAlert.testCaution();
                log('Caution alert with dropdown created successfully!', 'success');
            } else {
                log('Complete popup system not loaded!', 'error');
            }
        }
        
        function testSafe() {
            log('Testing Safe Email Alert with dropdown...', 'warning');
            if (window.completePhishingAlert) {
                window.completePhishingAlert.testSafe();
                log('Safe email alert with dropdown created successfully!', 'success');
            } else {
                log('Complete popup system not loaded!', 'error');
            }
        }
        
        function clearAllAlerts() {
            log('Clearing all popup alerts...', 'info');
            document.querySelectorAll('.complete-phishing-alert').forEach(el => {
                el.remove();
            });
            log('All alerts cleared successfully!', 'success');
        }
        
        function testMultipleAlerts() {
            log('Testing multiple alerts in sequence...', 'info');
            if (window.completePhishingAlert) {
                // Test sequence with delays
                setTimeout(() => {
                    testSafe();
                    log('Safe alert displayed', 'success');
                }, 500);
                
                setTimeout(() => {
                    testCaution();
                    log('Caution alert displayed', 'success');
                }, 2000);
                
                setTimeout(() => {
                    testWarning();
                    log('Warning alert displayed', 'success');
                }, 4000);
                
                setTimeout(() => {
                    testHighDanger();
                    log('High danger alert displayed', 'success');
                }, 6000);
                
                log('Multiple alert sequence started!', 'info');
            } else {
                log('Complete popup system not loaded!', 'error');
            }
        }
        
        function checkSystemStatus() {
            log('Checking system status...', 'info');
            
            // Check if popup system is loaded
            if (window.completePhishingAlert) {
                log('‚úÖ Complete popup system: LOADED', 'success');
            } else {
                log('‚ùå Complete popup system: NOT LOADED', 'error');
            }
            
            // Check if old system is also present
            if (window.phishingAlertUI) {
                log('‚ÑπÔ∏è Legacy popup system: Also available', 'info');
            }
            
            // Check browser capabilities
            log('üåê Browser: ' + navigator.userAgent.split(' ').pop(), 'info');
            log('üì± Screen: ' + screen.width + 'x' + screen.height, 'info');
            log('‚è∞ Current time: ' + new Date().toLocaleString(), 'info');
            
            log('System status check completed!', 'success');
        }
        
        function showInstructions() {
            log('Showing popup instructions...', 'info');
            
            const instructions = [
                '1. Click any colored test button above',
                '2. Look for popup in TOP-RIGHT corner of screen',
                '3. Click "View Analysis Details" to expand dropdown',
                '4. Explore risk bars, reasons, and assessment text',
                '5. Try different alert types (High Danger, Warning, etc.)',
                '6. Use "Clear All Alerts" to remove popups'
            ];
            
            instructions.forEach((instruction, index) => {
                setTimeout(() => {
                    log(instruction, 'info');
                }, index * 500);
            });
            
            setTimeout(() => {
                log('Instructions completed! Try testing now.', 'success');
            }, instructions.length * 500 + 500);
        }
        
        // Initialize
        window.addEventListener('load', () => {
            log('Complete popup test page loaded successfully!', 'success');
            
            setTimeout(() => {
                checkSystemStatus();
            }, 1000);
            
            setTimeout(() => {
                log('Ready to test! Click any button above to see popup with dropdown.', 'info');
                log('üí° TIP: Look in the TOP-RIGHT corner for the popup alert!', 'warning');
            }, 2000);
        });
        
        // Listen for popup events
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('dropdown-toggle')) {
                log('Dropdown toggle clicked - expanding/collapsing analysis details', 'info');
            }
            
            if (e.target.classList.contains('alert-close-btn')) {
                log('Popup close button clicked - removing alert', 'info');
            }
        });
    </script>
</body>
</html>